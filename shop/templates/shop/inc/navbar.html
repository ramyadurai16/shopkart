<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="{% url 'home' %}">
      <i class="fa fa-cart-plus"></i> ShopKart
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
      data-bs-target="#navbarNavAltMarkup">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav ms-auto align-items-center">

        <!-- ðŸ” SEARCH FORM -->
        <form class="d-flex me-3 position-relative align-items-center"
              method="GET"
              action="{% url 'product_list' %}"
              style="width:420px;">

          <select name="category" class="form-select" onchange="this.form.submit()">
            <option value="">All Categories</option>
            {% for cat in categories %}
              <option value="{{ cat.name }}"
                {% if cat.name == selected_category %}selected{% endif %}>
                {{ cat.name }}
              </option>
            {% endfor %}
          </select>

          <input class="form-control ms-2"
                 type="text"
                 name="query"
                 placeholder="Search products..."
                 value="{{ query|default:'' }}">

          <button class="btn btn-warning ms-1" type="submit">
            <i class="fa fa-search"></i>
          </button>
        </form>

        <!-- ðŸ  HOME -->
        <a class="nav-link" href="{% url 'home' %}">
          <i class="fa fa-home"></i> Home
        </a>

        <!-- ðŸ‘¤ AUTH LOGIC -->
        {% if request.user.is_authenticated %}

          {% if request.user.is_staff %}
            <!-- ðŸ‘¨â€ðŸ’¼ ADMIN -->
            <a class="nav-link" href="{% url 'admin_orders' %}">
              <i class="fa fa-list"></i> Admin Orders
            </a>

          {% else %}
            <!-- ðŸ‘¤ NORMAL USER -->
            <a class="nav-link">
              <i class="fa fa-user"></i> {{ request.user.username }}
            </a>

            <a class="nav-link" href="{% url 'my_orders' %}">
              <i class="fa fa-shopping-bag"></i> Orders
            </a>
          {% endif %}

          <a class="nav-link" href="{% url 'logout' %}">
            <i class="fa fa-sign-out"></i> Logout
          </a>

        {% else %}
          <!-- ðŸšª GUEST -->
          <a class="nav-link" href="{% url 'login' %}">
            <i class="fa fa-sign-in"></i> Login
          </a>
          <a class="nav-link" href="{% url 'register' %}">
            <i class="fa fa-users"></i> Register
          </a>
        {% endif %}

        <!-- ðŸ›’ COMMON LINKS -->
        <a class="nav-link" href="{% url 'collections' %}">
          <i class="fa fa-cubes"></i> Collections
        </a>
        <a class="nav-link" href="{% url 'cart' %}">
          <i class="fa fa-shopping-cart"></i> Cart
        </a>
        <a class="nav-link" href="{% url 'favviewpage' %}">
          <i class="fa fa-heart"></i> Favourite
        </a>

      </div>
    </div>
  </div>
</nav>
